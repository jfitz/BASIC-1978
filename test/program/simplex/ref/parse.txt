10 REM SOLVE LINEAR PROGRAM VIA SIMPLEX ALGORITHM
 Remark:SOLVE LINEAR PROGRAM VIA SIMPLEX ALGORITHM
15 OPTION BASE 1
 NumericConstant:1
20 REM N1 = 0 ' NUMBER OF DECISION VARIABLES
 Remark:N1 = 0 ' NUMBER OF DECISION VARIABLES
21 REM N2 = 0 ' NUMBER OF CONSTRAINTS (AND SLACK VARIABLES)
 Remark:N2 = 0 ' NUMBER OF CONSTRAINTS (AND SLACK VARIABLES)
30 REM X(N2, N1+N2) ' CENTRAL MATRIX
 Remark:X(N2, N1+N2) ' CENTRAL MATRIX
31 REM B(N2)        ' RIGHT-HAND SIDE VALUES
 Remark:B(N2)        ' RIGHT-HAND SIDE VALUES
32 REM C1$(N2)      ' NAMES OF BASIC VARIABLES
 Remark:C1$(N2)      ' NAMES OF BASIC VARIABLES
33 REM C$(N1+N2)    ' NAMES OF DECISION AND SLACK VARIABLES
 Remark:C$(N1+N2)    ' NAMES OF DECISION AND SLACK VARIABLES
34 REM C(N1+N2)     ' COEFFICIENTS FOR OBJECTIVE FUNCTION
 Remark:C(N1+N2)     ' COEFFICIENTS FOR OBJECTIVE FUNCTION
35 REM Z(N1+N2)     ' EVAL STEP FOR PIVOT COLUMN SELECTION
 Remark:Z(N1+N2)     ' EVAL STEP FOR PIVOT COLUMN SELECTION
36 REM B1(N2)       ' EVAL STEP FOR PIVOT ROW SELECTION
 Remark:B1(N2)       ' EVAL STEP FOR PIVOT ROW SELECTION
37 REM R()          ' OBJECTIVE COEFFICIENT FOR BASIC VARIABLE
 Remark:R()          ' OBJECTIVE COEFFICIENT FOR BASIC VARIABLE
38 REM I0, J0       ' ROW AND COLUMN OF PIVOT CELL
 Remark:I0, J0       ' ROW AND COLUMN OF PIVOT CELL
100 REM READ DIMENSIONS
 Remark:READ DIMENSIONS
101 READ N1, N2
 Reference:N1
 Reference:N2
110 REM BUILD COEFFICIENTS FOR EXPANDED OBJECTIVE FUNCTION
 Remark:BUILD COEFFICIENTS FOR EXPANDED OBJECTIVE FUNCTION
111 DIM C(N1)
 ScalarValue:N1
 Declaration:C
112 ARR READ C
 Reference:C
113 DIM C(N1+N2)' EXPAND TO INCLUDE SLACK VARIABLES
 ScalarValue:N1
 ScalarValue:N2
 BinaryOperator:+
 Declaration:C
114 C(J) = 0 FOR J = N1 + 1 TO N1+N2
 ScalarValue:J
 Reference:C
 NumericConstant:0
 AssignmentOperator:=
120 REM BUILD NAMES OF DECISION VARIABLES AND SLACK VARIABLES
 Remark:BUILD NAMES OF DECISION VARIABLES AND SLACK VARIABLES
121 DIM C$(N1+N2)
 ScalarValue:N1
 ScalarValue:N2
 BinaryOperator:+
 Declaration:C$
122 FOR I = 1 TO N1
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N1"]
123   C$(I) = "X" + STR$(I)
 ScalarValue:I
 Reference:C$
 TextConstant:"X"
 ScalarValue:I
 FunctionStr
 BinaryOperator:+
 AssignmentOperator:=
124 NEXT I
 Variable:I
125 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
126   C$(I+N1) = "S" + STR$(I)
 ScalarValue:I
 ScalarValue:N1
 BinaryOperator:+
 Reference:C$
 TextConstant:"S"
 ScalarValue:I
 FunctionStr
 BinaryOperator:+
 AssignmentOperator:=
127 NEXT I
 Variable:I
128 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
129   C1$(I) = C$(I+N1)
 ScalarValue:I
 Reference:C1$
 ScalarValue:I
 ScalarValue:N1
 BinaryOperator:+
 ScalarValue:C$
 AssignmentOperator:=
130 NEXT I
 Variable:I
140 REM BUILD CENTRAL MATRIX (CONSTRAINTS)
 Remark:BUILD CENTRAL MATRIX (CONSTRAINTS)
141 DIM X(N2, N1)
 ScalarValue:N2
 ScalarValue:N1
 Declaration:X
142 MAT READ X
 Reference:X
143 DIM X(N2, N1+N2)' EXPAND TO INCLUDE SLACK VARIABLES
 ScalarValue:N2
 ScalarValue:N1
 ScalarValue:N2
 BinaryOperator:+
 Declaration:X
144 X(I,J) = 0 FOR J = N1+1 TO N1+N2 FOR I = 1 TO N2
 ScalarValue:I
 ScalarValue:J
 Reference:X
 NumericConstant:0
 AssignmentOperator:=
145 X(I,I+N1) = 1 FOR I = 1 TO N2 ' SET EXPANSION TO IDEN MATRIX
 ScalarValue:I
 ScalarValue:I
 ScalarValue:N1
 BinaryOperator:+
 Reference:X
 NumericConstant:1
 AssignmentOperator:=
160 REM BUILD RIGHT-HAND SIDE VALUES (CONSTANTS)
 Remark:BUILD RIGHT-HAND SIDE VALUES (CONSTANTS)
161 DIM B(N2)
 ScalarValue:N2
 Declaration:B
162 ARR READ B
 Reference:B
170 REM COPY COEFFICIENTS FOR BASIC VARIABLES
 Remark:COPY COEFFICIENTS FOR BASIC VARIABLES
171 DIM R(N2)
 ScalarValue:N2
 Declaration:R
172 R(I) = 0 FOR I = 1 TO N2
 ScalarValue:I
 Reference:R
 NumericConstant:0
 AssignmentOperator:=
200 REM PRINT THE TABLEAU
 Remark:PRINT THE TABLEAU
201 PRINT
 ITEMS
 CarriageControl:NL
202 PRINT "TABLEAU"
 ITEMS
 TextConstant:"TABLEAU"
 CarriageControl:NL
203 PRINT
 ITEMS
 CarriageControl:NL
204 PRINT " ","C->",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"C->"
 CarriageControl:,
205 ARR PRINT C
 ITEMS
 ArrayValue:C
 CarriageControl:NL
210 PRINT "CB","BV",
 ITEMS
 TextConstant:"CB"
 CarriageControl:,
 TextConstant:"BV"
 CarriageControl:,
211 PRINT C$(I), FOR I = 1 TO N1+N2 
 ITEMS
 ScalarValue:I
 ScalarValue:C$
 CarriageControl:,
212 PRINT "B"
 ITEMS
 TextConstant:"B"
 CarriageControl:NL
220 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
221   PRINT R(I),C1$(I),
 ITEMS
 ScalarValue:I
 ScalarValue:R
 CarriageControl:,
 ScalarValue:I
 ScalarValue:C1$
 CarriageControl:,
222   PRINT X(I,J), FOR J = 1 TO N1+N2
 ITEMS
 ScalarValue:I
 ScalarValue:J
 ScalarValue:X
 CarriageControl:,
230   PRINT B(I)
 ITEMS
 ScalarValue:I
 ScalarValue:B
 CarriageControl:NL
239 NEXT I
 Variable:I
300 REM EVALUATE TABLEAU FOR OPTIMUM SOLUTION
 Remark:EVALUATE TABLEAU FOR OPTIMUM SOLUTION
301 DIM Z(N1+N2)
 ScalarValue:N1
 ScalarValue:N2
 BinaryOperator:+
 Declaration:Z
302 Z(J) = 0 FOR J = 1 TO N1+N2
 ScalarValue:J
 Reference:Z
 NumericConstant:0
 AssignmentOperator:=
305 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
306   Z(J) = Z(J) + R(I)*X(I,J) FOR J = 1 TO N1+N2
 ScalarValue:J
 Reference:Z
 ScalarValue:J
 ScalarValue:Z
 ScalarValue:I
 ScalarValue:R
 ScalarValue:I
 ScalarValue:J
 ScalarValue:X
 BinaryOperator:*
 BinaryOperator:+
 AssignmentOperator:=
307 NEXT I
 Variable:I
310 REM COMPUTE Z - C
 Remark:COMPUTE Z - C
311 ARR Y = Z - C
 Reference:Y
 ArrayValue:Z
 ArrayValue:C
 BinaryOperator:-
 AssignmentOperator:=
320 REM CHECK FOR OPTIMUM, IDENTIFY KEY COLUMN
 Remark:CHECK FOR OPTIMUM, IDENTIFY KEY COLUMN
321 J0 = 0
 Reference:J0
 NumericConstant:0
 AssignmentOperator:=
322 M = 0
 Reference:M
 NumericConstant:0
 AssignmentOperator:=
323 FOR J = 1 TO N1+N2
 control: Variable:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N1", "ScalarValue:N2", "BinaryOperator:+"]
324   IF Y(J) >= M THEN 327
 ScalarValue:J
 ScalarValue:Y
 ScalarValue:M
 BinaryOperator:>=
325   J0 = J
 Reference:J0
 ScalarValue:J
 AssignmentOperator:=
326   M = Y(J)
 Reference:M
 ScalarValue:J
 ScalarValue:Y
 AssignmentOperator:=
327 NEXT J
 Variable:J
328 IF M >= 0 THEN 500
 ScalarValue:M
 NumericConstant:0
 BinaryOperator:>=
329 PRINT "NON-OPTIMUM."
 ITEMS
 TextConstant:"NON-OPTIMUM."
 CarriageControl:NL
330 REM EVALUATE BASIC VARIABLES
 Remark:EVALUATE BASIC VARIABLES
331 DIM W(N2)
 ScalarValue:N2
 Declaration:W
332 W(I) = 0 FOR I = 1 TO N2
 ScalarValue:I
 Reference:W
 NumericConstant:0
 AssignmentOperator:=
333 W(I) = B(I) / X(I,J0) IF X(I,J0) <> 0 FOR I = 1 TO N2
 ScalarValue:I
 Reference:W
 ScalarValue:I
 ScalarValue:B
 ScalarValue:I
 ScalarValue:J0
 ScalarValue:X
 BinaryOperator:/
 AssignmentOperator:=
340 REM PRINT TABLEAU WITH EVALUATION ROWS AND COLUMNS
 Remark:PRINT TABLEAU WITH EVALUATION ROWS AND COLUMNS
341 PRINT
 ITEMS
 CarriageControl:NL
342 PRINT "EXPANDED TABLEAU"
 ITEMS
 TextConstant:"EXPANDED TABLEAU"
 CarriageControl:NL
343 PRINT
 ITEMS
 CarriageControl:NL
344 PRINT " ","C->",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"C->"
 CarriageControl:,
345 ARR PRINT C
 ITEMS
 ArrayValue:C
 CarriageControl:NL
350 PRINT "CB","BV",
 ITEMS
 TextConstant:"CB"
 CarriageControl:,
 TextConstant:"BV"
 CarriageControl:,
351 PRINT C$(I), FOR I = 1 TO N1+N2 
 ITEMS
 ScalarValue:I
 ScalarValue:C$
 CarriageControl:,
352 PRINT "B","B / ";C$(J0)
 ITEMS
 TextConstant:"B"
 CarriageControl:,
 TextConstant:"B / "
 CarriageControl:;
 ScalarValue:J0
 ScalarValue:C$
 CarriageControl:NL
360 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
361   PRINT R(I),C1$(I),
 ITEMS
 ScalarValue:I
 ScalarValue:R
 CarriageControl:,
 ScalarValue:I
 ScalarValue:C1$
 CarriageControl:,
362   PRINT X(I,J), FOR J = 1 TO N1+N2
 ITEMS
 ScalarValue:I
 ScalarValue:J
 ScalarValue:X
 CarriageControl:,
363   PRINT B(I),W(I)
 ITEMS
 ScalarValue:I
 ScalarValue:B
 CarriageControl:,
 ScalarValue:I
 ScalarValue:W
 CarriageControl:NL
364 NEXT I
 Variable:I
370 PRINT " ", "Z",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"Z"
 CarriageControl:,
371 ARR PRINT Z
 ITEMS
 ArrayValue:Z
 CarriageControl:NL
372 PRINT " ", "Z-C",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"Z-C"
 CarriageControl:,
373 ARR PRINT Y
 ITEMS
 ArrayValue:Y
 CarriageControl:NL
374 PRINT "KEY COLUMN";J0;"VARIABLE ";C$(J0);" ENTERS"
 ITEMS
 TextConstant:"KEY COLUMN"
 CarriageControl:;
 ScalarValue:J0
 CarriageControl:;
 TextConstant:"VARIABLE "
 CarriageControl:;
 ScalarValue:J0
 ScalarValue:C$
 CarriageControl:;
 TextConstant:" ENTERS"
 CarriageControl:NL
380 REM IDENTIFY KEY ROW (SMALLEST POSITIVE VALUE OF W)
 Remark:IDENTIFY KEY ROW (SMALLEST POSITIVE VALUE OF W)
381 I0 = 0
 Reference:I0
 NumericConstant:0
 AssignmentOperator:=
382 M = 1E6
 Reference:M
 NumericConstant:1E6
 AssignmentOperator:=
383 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
384   IF W(I) <= 0 OR W(I) >= M THEN 387
 ScalarValue:I
 ScalarValue:W
 NumericConstant:0
 BinaryOperator:<=
 ScalarValue:I
 ScalarValue:W
 ScalarValue:M
 BinaryOperator:>=
 BinaryOperator:OR
385   I0 = I
 Reference:I0
 ScalarValue:I
 AssignmentOperator:=
386   M = W(I)
 Reference:M
 ScalarValue:I
 ScalarValue:W
 AssignmentOperator:=
387 NEXT I
 Variable:I
389 PRINT "KEY ROW";I0;"VARIABLE ";C1$(I0);" EXITS"
 ITEMS
 TextConstant:"KEY ROW"
 CarriageControl:;
 ScalarValue:I0
 CarriageControl:;
 TextConstant:"VARIABLE "
 CarriageControl:;
 ScalarValue:I0
 ScalarValue:C1$
 CarriageControl:;
 TextConstant:" EXITS"
 CarriageControl:NL
400 REM PIVOT ON KEY CELL
 Remark:PIVOT ON KEY CELL
401 REM CHANGE BASIC VARIABLE NAME AND COEFFICIENT
 Remark:CHANGE BASIC VARIABLE NAME AND COEFFICIENT
402 C1$(I0) = C$(J0)
 ScalarValue:I0
 Reference:C1$
 ScalarValue:J0
 ScalarValue:C$
 AssignmentOperator:=
403 R(I0) = C(J0)
 ScalarValue:I0
 Reference:R
 ScalarValue:J0
 ScalarValue:C
 AssignmentOperator:=
410 REM BUILD NEW MATRIX X2 AND ARRAY B2
 Remark:BUILD NEW MATRIX X2 AND ARRAY B2
411 MAT X2 = X
 Reference:X2
 MatrixValue:X
 AssignmentOperator:=
412 ARR B2 = B
 Reference:B2
 ArrayValue:B
 AssignmentOperator:=
420 REM ADJUST VALUES IN KEY ROW
 Remark:ADJUST VALUES IN KEY ROW
421 FOR J = 1 TO N1+N2
 control: Variable:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N1", "ScalarValue:N2", "BinaryOperator:+"]
422   X2(I0,J) = X(I0,J) / X(I0,J0)
 ScalarValue:I0
 ScalarValue:J
 Reference:X2
 ScalarValue:I0
 ScalarValue:J
 ScalarValue:X
 ScalarValue:I0
 ScalarValue:J0
 ScalarValue:X
 BinaryOperator:/
 AssignmentOperator:=
423 NEXT J
 Variable:J
430 REM ADJUST VALUES IN OTHER ROWS
 Remark:ADJUST VALUES IN OTHER ROWS
431 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
432   IF I = I0 THEN 436
 ScalarValue:I
 ScalarValue:I0
 BinaryOperator:=
433   FOR J = 1 TO N1+N2
 control: Variable:J
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N1", "ScalarValue:N2", "BinaryOperator:+"]
434     X2(I,J) = X(I,J) - X(I,J0)*X(I0,J)/X(I0,J0)
 ScalarValue:I
 ScalarValue:J
 Reference:X2
 ScalarValue:I
 ScalarValue:J
 ScalarValue:X
 ScalarValue:I
 ScalarValue:J0
 ScalarValue:X
 ScalarValue:I0
 ScalarValue:J
 ScalarValue:X
 BinaryOperator:*
 ScalarValue:I0
 ScalarValue:J0
 ScalarValue:X
 BinaryOperator:/
 BinaryOperator:-
 AssignmentOperator:=
435   NEXT J
 Variable:J
436 NEXT I
 Variable:I
440 REM ADJUST VALUES IN RIGHT-HAND-SIDE
 Remark:ADJUST VALUES IN RIGHT-HAND-SIDE
441 B2(I0) = B(I0) / X(I0,J0)
 ScalarValue:I0
 Reference:B2
 ScalarValue:I0
 ScalarValue:B
 ScalarValue:I0
 ScalarValue:J0
 ScalarValue:X
 BinaryOperator:/
 AssignmentOperator:=
442 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
443   IF I = I0 THEN 445
 ScalarValue:I
 ScalarValue:I0
 BinaryOperator:=
444   B2(I) = B(I) - X(I,J0)*B(I0)/X(I0,J0)
 ScalarValue:I
 Reference:B2
 ScalarValue:I
 ScalarValue:B
 ScalarValue:I
 ScalarValue:J0
 ScalarValue:X
 ScalarValue:I0
 ScalarValue:B
 BinaryOperator:*
 ScalarValue:I0
 ScalarValue:J0
 ScalarValue:X
 BinaryOperator:/
 BinaryOperator:-
 AssignmentOperator:=
445 NEXT I
 Variable:I
450 REM SWAP IN THE NEW MATRIX AND CONSTANTS
 Remark:SWAP IN THE NEW MATRIX AND CONSTANTS
451 MAT X = X2
 Reference:X
 MatrixValue:X2
 AssignmentOperator:=
452 ARR B = B2
 Reference:B
 ArrayValue:B2
 AssignmentOperator:=
453 GOTO 200
 LineNumber:200
500 REM NO MORE CHANGES
 Remark:NO MORE CHANGES
501 PRINT "SOLUTION FOUND"
 ITEMS
 TextConstant:"SOLUTION FOUND"
 CarriageControl:NL
511 PRINT " ", "Z",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"Z"
 CarriageControl:,
512 ARR PRINT Z
 ITEMS
 ArrayValue:Z
 CarriageControl:NL
513 PRINT " ", "Z-C",
 ITEMS
 TextConstant:" "
 CarriageControl:,
 TextConstant:"Z-C"
 CarriageControl:,
514 ARR PRINT Y
 ITEMS
 ArrayValue:Y
 CarriageControl:NL
520 PRINT "OBJECTIVE VALUE"
 ITEMS
 TextConstant:"OBJECTIVE VALUE"
 CarriageControl:NL
521 Z = 0
 Reference:Z
 NumericConstant:0
 AssignmentOperator:=
522 FOR I = 1 TO N2
 control: Variable:I
 start:   ["NumericConstant:1"]
 end:     ["ScalarValue:N2"]
523 PRINT C1$(I);" = ";B(I);" * ";R(I)
 ITEMS
 ScalarValue:I
 ScalarValue:C1$
 CarriageControl:;
 TextConstant:" = "
 CarriageControl:;
 ScalarValue:I
 ScalarValue:B
 CarriageControl:;
 TextConstant:" * "
 CarriageControl:;
 ScalarValue:I
 ScalarValue:R
 CarriageControl:NL
524 Z = Z + B(I)*R(I)
 Reference:Z
 ScalarValue:Z
 ScalarValue:I
 ScalarValue:B
 ScalarValue:I
 ScalarValue:R
 BinaryOperator:*
 BinaryOperator:+
 AssignmentOperator:=
525 NEXT I
 Variable:I
527 PRINT "Z = ";Z
 ITEMS
 TextConstant:"Z = "
 CarriageControl:;
 ScalarValue:Z
 CarriageControl:NL
999 STOP
 
4000 REM NUMBER DECISION VARS, NUMBER CONSTRAINTS
 Remark:NUMBER DECISION VARS, NUMBER CONSTRAINTS
4001 DATA 2,4
 NumericConstant:2
 NumericConstant:4
4010 REM COEFFICIENTS FOR OBJECTIVE FUNCTION (WITHOUT SLACK)
 Remark:COEFFICIENTS FOR OBJECTIVE FUNCTION (WITHOUT SLACK)
4011 DATA 20,14
 NumericConstant:20
 NumericConstant:14
4020 REM CONSTRAINT COEFFICIENTS (WITHOUT SLACK)
 Remark:CONSTRAINT COEFFICIENTS (WITHOUT SLACK)
4021 DATA 6,2,8,6,6,4,40,25
 NumericConstant:6
 NumericConstant:2
 NumericConstant:8
 NumericConstant:6
 NumericConstant:6
 NumericConstant:4
 NumericConstant:40
 NumericConstant:25
4030 REM RIGHT-HAND SIDE CONSTANTS
 Remark:RIGHT-HAND SIDE CONSTANTS
4031 DATA 2000,2000,1440,9600
 NumericConstant:2000
 NumericConstant:2000
 NumericConstant:1440
 NumericConstant:9600
4999 END
 
