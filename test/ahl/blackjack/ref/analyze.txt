Statistics:

Number of lines: 321
Number of valid statements: 322
Number of comments: 39
Number of executable statements: 321

Complexity:

Comment density: 0.121
Comprehension effort: 1061
McCabe complexity: 72
Halstead complexity:
 length: 1524
 volume: 8346.130
 difficulty: 66.093
 effort: 551618.154
 language: 1.911
 intelligence: 126.279
 time: 510.758

(0 4) 2 PRINT TAB(31); "BLACK JACK"
(0 4) 4 PRINT TAB(15); "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
(0 2) 6 PRINT
(0 2)   PRINT
(0 2)   PRINT
(0 7) 10 DEF FNA(Q) = Q + 11 * (Q >= 22)
(0 8) 20 DIM P(15, 12), Q(15), C(52), D(52), T(8), S(7), B(15)
(0 2) 30 DIM R(15)
(0 1) 40 REM --P(I,J) IS THE JTH CARD IN HAND I, Q(I) IS TOTAL OF HAND I
(0 1) 50 REM --C IS THE DECK BEING DEALT FROM, D IS THE DISCARD PILE,
(0 1) 60 REM --T(I) IS THE TOTAL FOR PLAYER I, S(I) IS THE TOTAL THIS HAND FOR
(0 1) 70 REM --PLAYER I, B(I) IS TH BET FOR HAND I
(0 1) 80 REM --R(I) IS THE LENGTH OF P(I,*)
(0 2) 90 GOTO 1500
(0 1) 100 REM --SUBROUTINE TO GET A CARD.  RESULT IS PUT IN X.
(1 4) 110 IF C < 51 THEN 230
(0 2) 120 PRINT "RESHUFFLING"
(1 5) 130 FOR D = D TO 1 STEP -1
(0 4) 140 C = C - 1
(0 3) 150 C(C) = D(D)
(0 1) 160 NEXT D
(1 5) 170 FOR C1 = 52 TO C STEP -1
(0 5) 180 C2 = INT(RND(1) * (C1 - C + 1)) + C
(0 3) 190 C3 = C(C2)
(0 3) 200 C(C2) = C(C1)
(0 3) 210 C(C1) = C3
(0 1) 220 NEXT C1
(0 3) 230 X = C(C)
(0 4) 240 C = C + 1
(0 1) 250 RETURN
(0 1) 300 REM --SUBROUTINE TO EVALUATE HAND I.  TOTAL IS PUT INTO
(0 1) 310 REM --Q(I). TOTALS HAVE THE FOLLOWING MEANING:
(0 1) 320 REM --  2-10...HARD 2-10
(0 1) 330 REM -- 11-21...SOFT 11-21
(0 1) 340 REM -- 22-32...HARD 11-21
(0 1) 350 REM --  33+....BUSTED
(0 3) 360 Q = 0
(1 3) 370 FOR Q2 = 1 TO R(I)
(0 3) 380 X = P(I, Q2)
(0 2) 390 GOSUB 500
(0 1) 400 NEXT Q2
(0 3) 410 Q(I) = Q
(0 1) 420 RETURN
(0 1) 500 REM --SUBROUTINE TO ADD CARD X TO TOTAL Q.
(0 3) 510 X1 = X
(1 6)     IF X1 > 10 THEN X1 = 10
(0 1)     REM  SAME AS X1=10 MIN X
(0 4) 520 Q1 = Q + X1
(1 4) 530 IF Q >= 11 THEN 590
(1 4) 540 IF X > 1 THEN 570
(0 4) 550 Q = Q + 11
(0 1) 560 RETURN
(0 8) 570 Q = Q1 - 11 * (Q1 >= 11)
(0 1) 580 RETURN
(0 9) 590 Q = Q1 - (Q <= 21 AND Q1 > 21)
(1 4) 600 IF Q < 33 THEN 620
(0 4) 610 Q = -1
(0 1) 620 RETURN
(0 1) 700 REM --CARD PRINTING SUBROUTINE
(0 1) 710 REM  D$ DEFINED ELSEWHERE
(0 3) 720 PRINT MID$(D$, 3 * X - 2, 3);
(0 2) 730 PRINT "  ";
(0 1) 740 RETURN
(0 1) 750 REM --ALTERNATIVE PRINTING ROUTINE
(0 4) 760 PRINT " "; MID$(D$, 3 * X - 1, 2);
(0 2) 770 PRINT "   ";
(0 1) 780 RETURN
(0 1) 800 REM --SUBROUTINE TO PLAY OUT A HAND.
(0 1) 810 REM --NO SPLITTING OR BLACKJACKS ALLOWED
(0 3) 820 H1 = 5
(0 2) 830 GOSUB 1410
(0 3) 840 H1 = 3
(2 4) 850 ON H GOTO 950, 930
(0 3) 860 GOSUB 100
(0 4) 870 B(I) = B(I) * 2
(0 2) 880 PRINT "RECEIVED A";
(0 3) 890 GOSUB 700
(0 2) 900 GOSUB 1100
(1 5) 910 IF Q > 0 THEN GOSUB 1300
(0 1) 920 RETURN
(0 2) 930 GOSUB 1320
(0 1) 940 RETURN
(0 3) 950 GOSUB 100
(0 2) 960 PRINT "RECEIVED A";
(0 3) 970 GOSUB 700
(0 2) 980 GOSUB 1100
(1 5) 990 IF Q < 0 THEN 940
(0 2) 1000 PRINT "HIT";
(0 3) 1010 GOTO 830
(0 1) 1100 REM --SUBROUTINE TO ADD A CARD TO ROW I
(0 4) 1110 R(I) = R(I) + 1
(0 3) 1120 P(I, R(I)) = X
(0 3) 1130 Q = Q(I)
(0 3) 1140 GOSUB 500
(0 3) 1150 Q(I) = Q
(1 4) 1160 IF Q >= 0 THEN 1190
(0 2) 1170 PRINT "...BUSTED"
(0 2) 1180 GOSUB 1200
(0 1) 1190 RETURN
(0 1) 1200 REM --SUBROUTINE TO DISCARD ROW I
(1 4) 1210 IF R(I) <> 0 THEN 1230
(0 1) 1220 RETURN
(0 4) 1230 D = D + 1
(0 3) 1240 D(D) = P(I, R(I))
(0 4) 1250 R(I) = R(I) - 1
(0 3) 1260 GOTO 1210
(0 1) 1300 REM --PRINTS TOTAL OF HAND I
(0 2) 1310 PRINT
(0 3) 1320 AA = Q(I)
(0 2)      GOSUB 3400
(0 3) 1325 PRINT "TOTAL IS"; AA
(0 1) 1330 RETURN
(0 1) 1400 REM --SUBROUTINE TO READ REPLY
(0 1) 1410 REM  I$ DEFINED ELSEWHERE
(1 2) 1420 INPUT H$
(0 4)      H$ = LEFT$(H$, 1)
(1 4) 1430 FOR H = 1 TO H1 STEP 2
(1 5) 1440 IF H$ = MID$(I$, H, 1) THEN 1480
(0 1) 1450 NEXT H
(0 8) 1460 PRINT "TYPE "; MID$(I$, 1, H1 - 1); " OR "; MID$(I$, H1, 2); " PLEASE";
(0 3) 1470 GOTO 1420
(0 5) 1480 H = (H + 1) / 2
(0 1) 1490 RETURN
(0 1) 1500 REM --PROGRAM STARTS HERE
(0 1) 1510 REM --INITIALIZE
(0 3) 1520 D$ = "  A  2  3  4  5  6  7  8  9 10  J  Q  K"
(0 3) 1530 I$ = "H,S,D,C"
(1 3) 1540 FOR I = 1 TO 13
(1 6) 1550 FOR J = 4 * I - 3 TO 4 * I
(0 3) 1560 D(J) = I
(0 1) 1570 NEXT J
(0 1) 1580 NEXT I
(0 3) 1590 D = 52
(0 3) 1600 C = 53
(0 2) 1610 PRINT "DO YOU WANT INSTRUCTIONS";
(1 2) 1620 INPUT H$
(1 9) 1630 IF LEFT$(H$, 1) = "N" OR LEFT$(H$, 1) = "n" THEN 1760
(0 2) 1640 PRINT "THIS IS THE GAME OF 21. AS MANY AS 7 PLAYERS MAY PLAY THE"
(0 2) 1650 PRINT "GAME. ON EACH DEAL, BETS WILL BE ASKED FOR, AND THE"
(0 2) 1660 PRINT "PLAYERS' BETS SHOULD BE TYPED IN. THE CARDS WILL THEN BE"
(0 2) 1670 PRINT "DEALT, AND EACH PLAYER IN TURN PLAYS HIS HAND. THE"
(0 2) 1680 PRINT "FIRST RESPONSE SHOULD BE EITHER 'D', INDICATING THAT THE"
(0 2) 1690 PRINT "PLAYER IS DOUBLING DOWN, 'S', INDICATING THAT HE IS"
(0 2) 1700 PRINT "STANDING, 'H', INDICATING HE WANTS ANOTHER CARD, OR '/',"
(0 2) 1710 PRINT "INDICATING THAT HE WANTS TO SPLIT HIS CARDS. AFTER THE"
(0 2) 1720 PRINT "INITIAL RESPONSE, ALL FURTHER RESPONSES SHOULD BE 'S' OR"
(0 2) 1730 PRINT "'H', UNLESS THE CARDS WERE SPLIT, IN WHICH CASE DOUBLING"
(0 2) 1740 PRINT "DOWN IS AGAIN PERMITTED. IN ORDER TO COLLECT FOR"
(0 2) 1750 PRINT "BLACKJACK, THE INITIAL RESPONSE SHOULD BE 'S'."
(0 2) 1760 PRINT "NUMBER OF PLAYERS";
(1 2) 1770 INPUT N
(0 2) 1775 PRINT
(1 12) 1780 IF N < 1 OR N > 7 OR N > INT(N) THEN 1760
(1 3) 1790 FOR I = 1 TO 8
(0 3)      T(I) = 0
(0 1)      NEXT I
(0 4) 1800 D1 = N + 1
(1 8) 1810 IF 2 * D1 + C >= 52 THEN GOSUB 120
(1 7) 1820 IF C = 2 THEN C = C - 1
(1 3) 1830 FOR I = 1 TO N
(0 3)      Z(I) = 0
(0 1)      NEXT I
(1 3) 1840 FOR I = 1 TO 15
(0 3)      B(I) = 0
(0 1)      NEXT I
(1 3) 1850 FOR I = 1 TO 15
(0 3)      Q(I) = 0
(0 1)      NEXT I
(1 3) 1860 FOR I = 1 TO 7
(0 3)      S(I) = 0
(0 1)      NEXT I
(1 3) 1870 FOR I = 1 TO 15
(0 3)      R(I) = 0
(0 1)      NEXT I
(0 2) 1880 PRINT "BETS:"
(1 3) 1890 FOR I = 1 TO N
(0 3)      PRINT "#"; I;
(1 2)      INPUT Z(I)
(0 1)      NEXT I
(1 3) 1900 FOR I = 1 TO N
(1 8) 1910 IF Z(I) <= 0 OR Z(I) > 500 THEN 1880
(0 3) 1920 B(I) = Z(I)
(0 1) 1930 NEXT I
(0 2) 1940 PRINT "PLAYER  ";
(1 3) 1950 FOR I = 1 TO N
(0 4) 1960 PRINT TAB(I * 7); I;
(0 1) 1970 NEXT I
(0 4) 1980 PRINT TAB((N + 1) * 7) "DEALER"
(1 3) 1990 FOR J = 1 TO 2
(0 3) 2000 PRINT TAB(7);
(1 3) 2010 FOR I = 1 TO D1
(0 3) 2020 GOSUB 100
(0 3) 2030 P(I, J) = X
(1 9) 2040 IF J = 1 OR I <= N THEN GOSUB 750
(0 1) 2050 NEXT I
(0 2) 2060 PRINT
(0 1) 2070 NEXT J
(1 3) 2080 FOR I = 1 TO D1
(0 3) 2090 R(I) = 2
(0 1) 2100 NEXT I
(0 1) 2110 REM --TEST FOR INSURANCE
(1 4) 2120 IF P(D1, 1) > 1 THEN 2240
(0 2) 2130 PRINT "ANY INSURANCE";
(1 2) 2140 INPUT H$
(1 5) 2150 IF LEFT$(H$, 1) <> "Y" THEN 2240
(0 2) 2160 PRINT "INSURANCE BETS"
(1 3) 2170 FOR I = 1 TO N
(0 3)      PRINT "#"; I;
(1 2)      INPUT Z(I)
(0 1)      NEXT I
(1 3) 2180 FOR I = 1 TO N
(1 10) 2190 IF Z(I) < 0 OR Z(I) > B(I) / 2 THEN 2160
(0 1) 2200 NEXT I
(1 3) 2210 FOR I = 1 TO N
(0 11) 2220 S(I) = Z(I) * (3 * (-(P(D1, 2) >= 10)) - 1)
(0 1) 2230 NEXT I
(0 1) 2240 REM --TEST FOR DEALER BLACKJACK
(0 3) 2250 L1 = 1
(0 3)      L2 = 1
(1 9) 2252 IF P(D1, 1) = 1 AND P(D1, 2) > 9 THEN L1 = 0
(0 3)      L2 = 0
(1 9) 2253 IF P(D1, 2) = 1 AND P(D1, 1) > 9 THEN L1 = 0
(0 3)      L2 = 0
(1 7) 2254 IF L1 <> 0 OR L2 <> 0 THEN 2320
(0 2) 2260 PRINT
(0 5)      PRINT "DEALER HAS A"; MID$(D$, 3 * P(D1, 2) - 2, 3); " IN THE HOLE ";
(0 2) 2270 PRINT "FOR BLACKJACK"
(1 3) 2280 FOR I = 1 TO D1
(0 3) 2290 GOSUB 300
(0 1) 2300 NEXT I
(0 2) 2310 GOTO 3140
(0 1) 2320 REM --NO DEALER BLACKJACK
(1 7) 2330 IF P(D1, 1) > 1 AND P(D1, 1) < 10 THEN 2350
(0 2) 2340 PRINT
(0 2)      PRINT "NO DEALER BLACKJACK."
(0 1) 2350 REM --NOW PLAY THE HANDS
(1 3) 2360 FOR I = 1 TO N
(0 3) 2370 PRINT "PLAYER"; I;
(0 3) 2380 H1 = 7
(0 3) 2390 GOSUB 1410
(4 6) 2400 ON H GOTO 2550, 2410, 2510, 2600
(0 1) 2410 REM --PLAYER WANTS TO STAND
(0 3) 2420 GOSUB 300
(1 4) 2430 IF Q(I) <> 21 THEN 2490
(0 2) 2440 PRINT "BLACKJACK"
(0 6) 2450 S(I) = S(I) + 1.5 * B(I)
(0 3) 2460 B(I) = 0
(0 3) 2470 GOSUB 1200
(0 2) 2480 GOTO 2900
(0 3) 2490 GOSUB 1320
(0 2) 2500 GOTO 2900
(0 1) 2510 REM --PLAYER WANTS TO DOUBLE DOWN
(0 3) 2520 GOSUB 300
(0 3) 2530 GOSUB 860
(0 2) 2540 GOTO 2900
(0 1) 2550 REM --PLAYER WANTS TO BE HIT
(0 3) 2560 GOSUB 300
(0 3) 2570 H1 = 3
(0 3) 2580 GOSUB 950
(0 2) 2590 GOTO 2900
(0 1) 2600 REM --PLAYER WANTS TO SPLIT
(0 3) 2610 L1 = P(I, 1)
(1 6)      IF P(I, 1) > 10 THEN L1 = 10
(0 3) 2612 L2 = P(I, 2)
(1 6)      IF P(I, 2) > 10 THEN L2 = 10
(1 4) 2614 IF L1 = L2 THEN 2640
(0 2) 2620 PRINT "SPLITTING NOT ALLOWED."
(0 3) 2630 GOTO 2370
(0 1) 2640 REM --PLAY OUT SPLIT
(0 4) 2650 I1 = I + D1
(0 3) 2660 R(I1) = 2
(0 3) 2670 P(I1, 1) = P(I, 2)
(0 3) 2680 B(I + D1) = B(I)
(0 3) 2690 GOSUB 100
(0 2) 2700 PRINT "FIRST HAND RECEIVES A";
(0 3) 2710 GOSUB 700
(0 3) 2720 P(I, 2) = X
(0 3) 2730 GOSUB 300
(0 2) 2740 PRINT
(0 3) 2750 GOSUB 100
(0 2) 2760 PRINT "SECOND HAND RECEIVES A";
(0 3) 2770 I = I1
(0 3) 2780 GOSUB 700
(0 3) 2790 P(I, 2) = X
(0 3) 2800 GOSUB 300
(0 2) 2810 PRINT
(0 4) 2820 I = I1 - D1
(1 4) 2830 IF P(I, 1) = 1 THEN 2900
(0 1) 2840 REM --NOW PLAY THE TWO HANDS
(0 6) 2850 PRINT "HAND"; 1 - (I > D1);
(0 3) 2860 GOSUB 800
(0 4) 2870 I = I + D1
(1 5) 2880 IF I = I1 THEN 2850
(0 4) 2890 I = I1 - D1
(0 1) 2900 NEXT I
(0 3) 2910 GOSUB 300
(0 1) 2920 REM --TEST FOR PLAYING DEALER'S HAND
(1 3) 2930 FOR I = 1 TO N
(1 7) 2940 IF R(I) > 0 OR R(I + D1) > 0 THEN 3010
(0 1) 2950 NEXT I
(0 2) 2960 PRINT "DEALER HAD A";
(0 3) 2970 X = P(D1, 2)
(0 3) 2980 GOSUB 700
(0 2) 2990 PRINT "CONCEALED."
(0 2) 3000 GOTO 3140
(0 5) 3010 PRINT "DEALER HAS A"; MID$(D$, 3 * P(D1, 2) - 2, 3); " CONCEALED ";
(0 3) 3020 I = D1
(0 3) 3030 AA = Q(I)
(0 2)      GOSUB 3400
(0 3) 3035 PRINT "FOR A TOTAL OF"; AA
(1 4) 3040 IF AA > 16 THEN 3130
(0 2) 3050 PRINT "DRAWS";
(0 3) 3060 GOSUB 100
(0 3) 3070 GOSUB 750
(0 3) 3080 GOSUB 1100
(0 3) 3090 AA = Q
(0 2)      GOSUB 3400
(1 8) 3095 IF Q > 0 AND AA < 17 THEN 3060
(0 7) 3100 Q(I) = Q - (Q < 0) / 2
(1 4) 3110 IF Q < 0 THEN 3140
(0 3) 3120 AA = Q
(0 2)      GOSUB 3400
(0 3) 3125 PRINT "---TOTAL IS"; AA
(0 2) 3130 PRINT
(0 1) 3140 REM --TALLY THE RESULT
(0 1) 3150 REM
(0 3) 3160 Z$ = "LOSES PUSHES WINS "
(0 2) 3165 PRINT
(1 3) 3170 FOR I = 1 TO N
(0 3) 3180 AA = Q(I)
(0 2)      GOSUB 3400
(0 3) 3182 AB = Q(I + D1)
(0 2)      GOSUB 3410
(0 3) 3184 AC = Q(D1)
(0 2)      GOSUB 3420
(0 11) 3186 S(I) = S(I) + B(I) * SGN(AA - AC) + B(I + D1) * SGN(AB - AC)
(0 3) 3188 B(I + D1) = 0
(0 3) 3200 PRINT "PLAYER"; I;
(0 4) 3210 PRINT MID$(Z$, SGN(S(I)) * 6 + 7, 6); " ";
(1 4) 3220 IF S(I) <> 0 THEN 3250
(0 2) 3230 PRINT "      ";
(0 2) 3240 GOTO 3260
(0 3) 3250 PRINT ABS(S(I));
(0 4) 3260 T(I) = T(I) + S(I)
(0 3) 3270 PRINT "TOTAL="; T(I)
(0 3) 3280 GOSUB 1200
(0 4) 3290 T(D1) = T(D1) - S(I)
(0 4) 3300 I = I + D1
(0 3) 3310 GOSUB 1200
(0 4) 3320 I = I - D1
(0 1) 3330 NEXT I
(0 3) 3340 PRINT "DEALER'S TOTAL="; T(D1)
(0 2) 3345 PRINT
(0 3) 3350 GOSUB 1200
(0 3) 3360 GOTO 1810
(0 8) 3400 AA = AA + 11 * (AA >= 22)
(0 1)      RETURN
(0 8) 3410 AB = AB + 11 * (AB >= 22)
(0 1)      RETURN
(0 8) 3420 AC = AC + 11 * (AC >= 22)
(0 1)      RETURN

Unreachable code:

All executable lines are reachable.

