                               BLACK JACK
               CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY



DO YOU WANT INSTRUCTIONS? NO
NUMBER OF PLAYERS? 2

RESHUFFLING
BETS:
# 1 ? 50
# 2 ? 45
PLAYER   1     2     DEALER
         9     K     9   
         J    10   
PLAYER 1 ? H
RECEIVED A  A  HIT? S
TOTAL IS 20
PLAYER 2 ? S
TOTAL IS 20
DEALER HAS A  5 CONCEALED FOR A TOTAL OF 0
DRAWS  4     Q     K   ...BUSTED

PLAYER 1  WINS   50 TOTAL= 50
PLAYER 2  WINS   45 TOTAL= 45
DEALER'S TOTAL=-95

BETS:
# 1 ? 50
# 2 ? 45
PLAYER   1     2     DEALER
         6     3     8   
         7     J   
PLAYER 1 ? H
RECEIVED A  2  HIT? H
RECEIVED A  4  HIT? S
TOTAL IS 19
PLAYER 2 ? H
RECEIVED A  3  HIT? H
RECEIVED A 10  ...BUSTED
DEALER HAS A  5 CONCEALED FOR A TOTAL OF 0
DRAWS 10     8   ---TOTAL IS 18


PLAYER 1  WINS   50 TOTAL= 100
PLAYER 2 LOSES   45 TOTAL= 0
DEALER'S TOTAL=-100

BETS:
# 1 ? 
Error 102 End of file in line 1890

2 (1) PRINT TAB(31); "BLACK JACK"
4 (1) PRINT TAB(15); "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
6 (1) PRINT
  (1) PRINT
  (1) PRINT
10 (1) DEF FNA(Q) = Q + 11 * (Q >= 22)
20 (1) DIM P(15, 12), Q(15), C(52), D(52), T(8), S(7), B(15)
30 (1) DIM R(15)
40 (1) REM --P(I,J) IS THE JTH CARD IN HAND I, Q(I) IS TOTAL OF HAND I
50 (1) REM --C IS THE DECK BEING DEALT FROM, D IS THE DISCARD PILE,
60 (1) REM --T(I) IS THE TOTAL FOR PLAYER I, S(I) IS THE TOTAL THIS HAND FOR
70 (1) REM --PLAYER I, B(I) IS TH BET FOR HAND I
80 (1) REM --R(I) IS THE LENGTH OF P(I,*)
90 (1) GOTO 1500
100 (22) REM --SUBROUTINE TO GET A CARD.  RESULT IS PUT IN X.
110 (22) IF C < 51 THEN 230
120 (1) PRINT "RESHUFFLING"
130 (1) FOR D = D TO 1 STEP -1
140 (52) C = C - 1
150 (52) C(C) = D(D)
160 (52) NEXT D
170 (1) FOR C1 = 52 TO C STEP -1
180 (52) C2 = INT(RND(1) * (C1 - C + 1)) + C
190 (52) C3 = C(C2)
200 (52) C(C2) = C(C1)
210 (52) C(C1) = C3
220 (52) NEXT C1
230 (23) X = C(C)
240 (23) C = C + 1
250 (23) RETURN
300 (6) REM --SUBROUTINE TO EVALUATE HAND I.  TOTAL IS PUT INTO
310 (6) REM --Q(I). TOTALS HAVE THE FOLLOWING MEANING:
320 (6) REM --  2-10...HARD 2-10
330 (6) REM -- 11-21...SOFT 11-21
340 (6) REM -- 22-32...HARD 11-21
350 (6) REM --  33+....BUSTED
360 (6) Q = 0
370 (6) FOR Q2 = 1 TO R(I)
380 (10) X = P(I, Q2)
390 (10) GOSUB 500
400 (11) NEXT Q2
410 (6) Q(I) = Q
420 (6) RETURN
500 (20) REM --SUBROUTINE TO ADD CARD X TO TOTAL Q.
510 (20) X1 = X
    (20) IF X1 > 10 THEN X1 = 10
    (6) REM  SAME AS X1=10 MIN X
520 (20) Q1 = Q + X1
530 (20) IF Q >= 11 THEN 590
540 (14) IF X > 1 THEN 570
550 (0) Q = Q + 11
560 (0) RETURN
570 (14) Q = Q1 - 11 * (Q1 >= 11)
580 (14) RETURN
590 (6) Q = Q1 - (Q <= 21 AND Q1 > 21)
600 (6) IF Q < 33 THEN 620
610 (2) Q = -1
620 (6) RETURN
700 (5) REM --CARD PRINTING SUBROUTINE
710 (5) REM  D$ DEFINED ELSEWHERE
720 (5) PRINT MID$(D$, 3 * X - 2, 3);
730 (5) PRINT "  ";
740 (5) RETURN
750 (15) REM --ALTERNATIVE PRINTING ROUTINE
760 (15) PRINT " "; MID$(D$, 3 * X - 1, 2);
770 (15) PRINT "   ";
780 (15) RETURN
800 (0) REM --SUBROUTINE TO PLAY OUT A HAND.
810 (0) REM --NO SPLITTING OR BLACKJACKS ALLOWED
820 (0) H1 = 5
830 (4) GOSUB 1410
840 (4) H1 = 3
850 (4) ON H GOTO 950, 930
860 (0) GOSUB 100
870 (0) B(I) = B(I) * 2
880 (0) PRINT "RECEIVED A";
890 (0) GOSUB 700
900 (0) GOSUB 1100
910 (0) IF Q > 0 THEN GOSUB 1300
920 (0) RETURN
930 (2) GOSUB 1320
940 (3) RETURN
950 (5) GOSUB 100
960 (5) PRINT "RECEIVED A";
970 (5) GOSUB 700
980 (5) GOSUB 1100
990 (5) IF Q < 0 THEN 940
1000 (4) PRINT "HIT";
1010 (4) GOTO 830
1100 (10) REM --SUBROUTINE TO ADD A CARD TO ROW I
1110 (10) R(I) = R(I) + 1
1120 (10) P(I, R(I)) = X
1130 (10) Q = Q(I)
1140 (10) GOSUB 500
1150 (10) Q(I) = Q
1160 (10) IF Q >= 0 THEN 1190
1170 (2) PRINT "...BUSTED"
1180 (2) GOSUB 1200
1190 (10) RETURN
1200 (12) REM --SUBROUTINE TO DISCARD ROW I
1210 (30) IF R(I) <> 0 THEN 1230
1220 (12) RETURN
1230 (18) D = D + 1
1240 (18) D(D) = P(I, R(I))
1250 (18) R(I) = R(I) - 1
1260 (18) GOTO 1210
1300 (0) REM --PRINTS TOTAL OF HAND I
1310 (0) PRINT
1320 (3) AA = Q(I)
     (3) GOSUB 3400
1325 (3) PRINT "TOTAL IS"; AA
1330 (3) RETURN
1400 (0) REM --SUBROUTINE TO READ REPLY
1410 (8) REM  I$ DEFINED ELSEWHERE
1420 (8) INPUT H$
     (8) H$ = LEFT$(H$, 1)
1430 (8) FOR H = 1 TO H1 STEP 2
1440 (11) IF H$ = MID$(I$, H, 1) THEN 1480
1450 (3) NEXT H
1460 (0) PRINT "TYPE "; MID$(I$, 1, H1 - 1); " OR "; MID$(I$, H1, 2); " PLEASE";
1470 (0) GOTO 1420
1480 (8) H = (H + 1) / 2
1490 (8) RETURN
1500 (1) REM --PROGRAM STARTS HERE
1510 (1) REM --INITIALIZE
1520 (1) D$ = "  A  2  3  4  5  6  7  8  9 10  J  Q  K"
1530 (1) I$ = "H,S,D,C"
1540 (1) FOR I = 1 TO 13
1550 (13) FOR J = 4 * I - 3 TO 4 * I
1560 (52) D(J) = I
1570 (52) NEXT J
1580 (13) NEXT I
1590 (1) D = 52
1600 (1) C = 53
1610 (1) PRINT "DO YOU WANT INSTRUCTIONS";
1620 (1) INPUT H$
1630 (1) IF LEFT$(H$, 1) = "N" OR LEFT$(H$, 1) = "n" THEN 1760
1640 (0) PRINT "THIS IS THE GAME OF 21. AS MANY AS 7 PLAYERS MAY PLAY THE"
1650 (0) PRINT "GAME. ON EACH DEAL, BETS WILL BE ASKED FOR, AND THE"
1660 (0) PRINT "PLAYERS' BETS SHOULD BE TYPED IN. THE CARDS WILL THEN BE"
1670 (0) PRINT "DEALT, AND EACH PLAYER IN TURN PLAYS HIS HAND. THE"
1680 (0) PRINT "FIRST RESPONSE SHOULD BE EITHER 'D', INDICATING THAT THE"
1690 (0) PRINT "PLAYER IS DOUBLING DOWN, 'S', INDICATING THAT HE IS"
1700 (0) PRINT "STANDING, 'H', INDICATING HE WANTS ANOTHER CARD, OR '/',"
1710 (0) PRINT "INDICATING THAT HE WANTS TO SPLIT HIS CARDS. AFTER THE"
1720 (0) PRINT "INITIAL RESPONSE, ALL FURTHER RESPONSES SHOULD BE 'S' OR"
1730 (0) PRINT "'H', UNLESS THE CARDS WERE SPLIT, IN WHICH CASE DOUBLING"
1740 (0) PRINT "DOWN IS AGAIN PERMITTED. IN ORDER TO COLLECT FOR"
1750 (0) PRINT "BLACKJACK, THE INITIAL RESPONSE SHOULD BE 'S'."
1760 (1) PRINT "NUMBER OF PLAYERS";
1770 (1) INPUT N
1775 (1) PRINT
1780 (1) IF N < 1 OR N > 7 OR N > INT(N) THEN 1760
1790 (1) FOR I = 1 TO 8
     (8) T(I) = 0
     (8) NEXT I
1800 (1) D1 = N + 1
1810 (3) IF 2 * D1 + C >= 52 THEN GOSUB 120
1820 (3) IF C = 2 THEN C = C - 1
1830 (3) FOR I = 1 TO N
     (6) Z(I) = 0
     (6) NEXT I
1840 (3) FOR I = 1 TO 15
     (45) B(I) = 0
     (45) NEXT I
1850 (3) FOR I = 1 TO 15
     (45) Q(I) = 0
     (45) NEXT I
1860 (3) FOR I = 1 TO 7
     (21) S(I) = 0
     (21) NEXT I
1870 (3) FOR I = 1 TO 15
     (45) R(I) = 0
     (45) NEXT I
1880 (3) PRINT "BETS:"
1890 (3) FOR I = 1 TO N
     (5) PRINT "#"; I;
     (4) INPUT Z(I)
     (4) NEXT I
1900 (2) FOR I = 1 TO N
1910 (4) IF Z(I) <= 0 OR Z(I) > 500 THEN 1880
1920 (4) B(I) = Z(I)
1930 (4) NEXT I
1940 (2) PRINT "PLAYER  ";
1950 (2) FOR I = 1 TO N
1960 (4) PRINT TAB(I * 7); I;
1970 (4) NEXT I
1980 (2) PRINT TAB((N + 1) * 7) "DEALER"
1990 (2) FOR J = 1 TO 2
2000 (4) PRINT TAB(7);
2010 (4) FOR I = 1 TO D1
2020 (12) GOSUB 100
2030 (12) P(I, J) = X
2040 (12) IF J = 1 OR I <= N THEN GOSUB 750
2050 (12) NEXT I
2060 (4) PRINT
2070 (4) NEXT J
2080 (2) FOR I = 1 TO D1
2090 (6) R(I) = 2
2100 (6) NEXT I
2110 (2) REM --TEST FOR INSURANCE
2120 (2) IF P(D1, 1) > 1 THEN 2240
2130 (0) PRINT "ANY INSURANCE";
2140 (0) INPUT H$
2150 (0) IF LEFT$(H$, 1) <> "Y" THEN 2240
2160 (0) PRINT "INSURANCE BETS"
2170 (0) FOR I = 1 TO N
     (0) PRINT "#"; I;
     (0) INPUT Z(I)
     (0) NEXT I
2180 (0) FOR I = 1 TO N
2190 (0) IF Z(I) < 0 OR Z(I) > B(I) / 2 THEN 2160
2200 (0) NEXT I
2210 (0) FOR I = 1 TO N
2220 (0) S(I) = Z(I) * (3 * (-(P(D1, 2) >= 10)) - 1)
2230 (0) NEXT I
2240 (2) REM --TEST FOR DEALER BLACKJACK
2250 (2) L1 = 1
     (2) L2 = 1
2252 (2) IF P(D1, 1) = 1 AND P(D1, 2) > 9 THEN L1 = 0
     (0) L2 = 0
2253 (2) IF P(D1, 2) = 1 AND P(D1, 1) > 9 THEN L1 = 0
     (0) L2 = 0
2254 (2) IF L1 <> 0 OR L2 <> 0 THEN 2320
2260 (0) PRINT
     (0) PRINT "DEALER HAS A"; MID$(D$, 3 * P(D1, 2) - 2, 3); " IN THE HOLE ";
2270 (0) PRINT "FOR BLACKJACK"
2280 (0) FOR I = 1 TO D1
2290 (0) GOSUB 300
2300 (0) NEXT I
2310 (0) GOTO 3140
2320 (2) REM --NO DEALER BLACKJACK
2330 (2) IF P(D1, 1) > 1 AND P(D1, 1) < 10 THEN 2350
2340 (0) PRINT
     (0) PRINT "NO DEALER BLACKJACK."
2350 (2) REM --NOW PLAY THE HANDS
2360 (2) FOR I = 1 TO N
2370 (4) PRINT "PLAYER"; I;
2380 (4) H1 = 7
2390 (4) GOSUB 1410
2400 (4) ON H GOTO 2550, 2410, 2510, 2600
2410 (1) REM --PLAYER WANTS TO STAND
2420 (1) GOSUB 300
2430 (1) IF Q(I) <> 21 THEN 2490
2440 (0) PRINT "BLACKJACK"
2450 (0) S(I) = S(I) + 1.5 * B(I)
2460 (0) B(I) = 0
2470 (0) GOSUB 1200
2480 (0) GOTO 2900
2490 (1) GOSUB 1320
2500 (1) GOTO 2900
2510 (0) REM --PLAYER WANTS TO DOUBLE DOWN
2520 (0) GOSUB 300
2530 (0) GOSUB 860
2540 (0) GOTO 2900
2550 (3) REM --PLAYER WANTS TO BE HIT
2560 (3) GOSUB 300
2570 (3) H1 = 3
2580 (3) GOSUB 950
2590 (3) GOTO 2900
2600 (0) REM --PLAYER WANTS TO SPLIT
2610 (0) L1 = P(I, 1)
     (0) IF P(I, 1) > 10 THEN L1 = 10
2612 (0) L2 = P(I, 2)
     (0) IF P(I, 2) > 10 THEN L2 = 10
2614 (0) IF L1 = L2 THEN 2640
2620 (0) PRINT "SPLITTING NOT ALLOWED."
2630 (0) GOTO 2370
2640 (0) REM --PLAY OUT SPLIT
2650 (0) I1 = I + D1
2660 (0) R(I1) = 2
2670 (0) P(I1, 1) = P(I, 2)
2680 (0) B(I + D1) = B(I)
2690 (0) GOSUB 100
2700 (0) PRINT "FIRST HAND RECEIVES A";
2710 (0) GOSUB 700
2720 (0) P(I, 2) = X
2730 (0) GOSUB 300
2740 (0) PRINT
2750 (0) GOSUB 100
2760 (0) PRINT "SECOND HAND RECEIVES A";
2770 (0) I = I1
2780 (0) GOSUB 700
2790 (0) P(I, 2) = X
2800 (0) GOSUB 300
2810 (0) PRINT
2820 (0) I = I1 - D1
2830 (0) IF P(I, 1) = 1 THEN 2900
2840 (0) REM --NOW PLAY THE TWO HANDS
2850 (0) PRINT "HAND"; 1 - (I > D1);
2860 (0) GOSUB 800
2870 (0) I = I + D1
2880 (0) IF I = I1 THEN 2850
2890 (0) I = I1 - D1
2900 (4) NEXT I
2910 (2) GOSUB 300
2920 (2) REM --TEST FOR PLAYING DEALER'S HAND
2930 (2) FOR I = 1 TO N
2940 (2) IF R(I) > 0 OR R(I + D1) > 0 THEN 3010
2950 (0) NEXT I
2960 (0) PRINT "DEALER HAD A";
2970 (0) X = P(D1, 2)
2980 (0) GOSUB 700
2990 (0) PRINT "CONCEALED."
3000 (0) GOTO 3140
3010 (2) PRINT "DEALER HAS A"; MID$(D$, 3 * P(D1, 2) - 2, 3); " CONCEALED ";
3020 (2) I = D1
3030 (2) AA = Q(I)
     (2) GOSUB 3400
3035 (2) PRINT "FOR A TOTAL OF"; AA
3040 (2) IF AA > 16 THEN 3130
3050 (2) PRINT "DRAWS";
3060 (5) GOSUB 100
3070 (5) GOSUB 750
3080 (5) GOSUB 1100
3090 (5) AA = Q
     (5) GOSUB 3400
3095 (5) IF Q > 0 AND AA < 17 THEN 3060
3100 (2) Q(I) = Q - (Q < 0) / 2
3110 (2) IF Q < 0 THEN 3140
3120 (1) AA = Q
     (1) GOSUB 3400
3125 (1) PRINT "---TOTAL IS"; AA
3130 (1) PRINT
3140 (2) REM --TALLY THE RESULT
3150 (2) REM
3160 (2) Z$ = "LOSES PUSHES WINS "
3165 (2) PRINT
3170 (2) FOR I = 1 TO N
3180 (4) AA = Q(I)
     (4) GOSUB 3400
3182 (4) AB = Q(I + D1)
     (4) GOSUB 3410
3184 (4) AC = Q(D1)
     (4) GOSUB 3420
3186 (4) S(I) = S(I) + B(I) * SGN(AA - AC) + B(I + D1) * SGN(AB - AC)
3188 (4) B(I + D1) = 0
3200 (4) PRINT "PLAYER"; I;
3210 (4) PRINT MID$(Z$, SGN(S(I)) * 6 + 7, 6); " ";
3220 (4) IF S(I) <> 0 THEN 3250
3230 (0) PRINT "      ";
3240 (0) GOTO 3260
3250 (4) PRINT ABS(S(I));
3260 (4) T(I) = T(I) + S(I)
3270 (4) PRINT "TOTAL="; T(I)
3280 (4) GOSUB 1200
3290 (4) T(D1) = T(D1) - S(I)
3300 (4) I = I + D1
3310 (4) GOSUB 1200
3320 (4) I = I - D1
3330 (4) NEXT I
3340 (2) PRINT "DEALER'S TOTAL="; T(D1)
3345 (2) PRINT
3350 (2) GOSUB 1200
3360 (2) GOTO 1810
3400 (15) AA = AA + 11 * (AA >= 22)
     (15) RETURN
3410 (4) AB = AB + 11 * (AB >= 22)
     (4) RETURN
3420 (4) AC = AC + 11 * (AC >= 22)
     (4) RETURN

