                                 NIM
               CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY



THIS IS THE GAME OF NIM.
DO YOU WANT INSTRUCTIONS? NO

ENTER WIN OPTION - 1 TO TAKE LAST, 2 TO AVOID LAST? 2
ENTER NUMBER OF PILES? 3
ENTER PILE SIZES
 1 ? 4
 2 ? 4
 3 ? 4
DO YOU WANT TO MOVE FIRST? YES
YOUR MOVE - PILE, NUMBER TO BE REMOVED? 1,1
PILE  SIZE
 1  0
 2  4
 3  4
YOUR MOVE - PILE, NUMBER TO BE REMOVED? 2,1
PILE  SIZE
 1  0
 2  3
 3  3
YOUR MOVE - PILE, NUMBER TO BE REMOVED? 2,1
PILE  SIZE
 1  0
 2  2
 3  2
YOUR MOVE - PILE, NUMBER TO BE REMOVED? 2,2
MACHINE WINS
do you want to play another game? NO
STOP in line 1730

100 (1) PRINT TAB(33); "NIM"
110 (1) PRINT TAB(15); "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
120 (1) PRINT
    (1) PRINT
    (1) PRINT
210 (1) DIM A(100), B(100, 10), D(2)
220 (1) PRINT "THIS IS THE GAME OF NIM."
230 (1) PRINT "DO YOU WANT INSTRUCTIONS";
240 (1) INPUT Z$
250 (1) IF Z$ = "NO" THEN 440
260 (0) IF Z$ = "no" THEN 440
270 (0) IF Z$ = "YES" THEN 310
280 (0) IF Z$ = "yes" THEN 310
290 (0) PRINT "PLEASE ANSWER YES OR NO"
300 (0) GOTO 240
310 (0) PRINT "THE GAME IS PLAYED WITH A NUMBER OF PILES OF OBJECTS."
320 (0) PRINT "ANY NUMBER OF OBJECTS ARE REMOVED FROM ONE PILE BY YOU AND"
330 (0) PRINT "THE MACHINE ALTERNATELY.  ON YOUR TURN, YOU MAY TAKE"
340 (0) PRINT "ALL THE OBJECTS THAT REMAIN IN ANY PILE, BUT YOU MUST"
350 (0) PRINT "TAKE AT LEAST ONE OBJECT, AND YOU MAY TAKE OBJECTS FROM"
360 (0) PRINT "ONLY ONE PILE ON A SINGLE TURN.  YOU MUST SPECIFY WHETHER"
370 (0) PRINT "WINNING IS DEFINED AS TAKING OR NOT TAKING THE LAST OBJECT,"
380 (0) PRINT "THE NUMBER OF PILES IN THE GAME, AND HOW MANY OBJECTS ARE"
390 (0) PRINT "ORIGINALLY IN EACH PILE.  EACH PILE MAY CONTAIN A"
400 (0) PRINT "DIFFERENT NUMBER OF OBJECTS."
410 (0) PRINT "THE MACHINE WILL SHOW ITS MOVE BY LISTING EACH PILE AND THE"
420 (0) PRINT "NUMBER OF OBJECTS REMAINING IN THE PILES AFTER  EACH OF ITS"
430 (0) PRINT "MOVES."
440 (1) PRINT
450 (1) PRINT "ENTER WIN OPTION - 1 TO TAKE LAST, 2 TO AVOID LAST";
460 (1) INPUT W
470 (1) IF W = 1 THEN 490
480 (1) IF W <> 2 THEN 450
490 (1) PRINT "ENTER NUMBER OF PILES";
500 (1) INPUT N
510 (1) IF N > 100 THEN 490
520 (1) IF N < 1 THEN 490
530 (1) IF N <> INT(N) THEN 490
540 (1) PRINT "ENTER PILE SIZES"
550 (1) FOR I = 1 TO N
560 (3) PRINT I;
570 (3) INPUT A(I)
580 (3) IF A(I) > 2000 THEN 560
590 (3) IF A(I) < 1 THEN 560
600 (3) IF A(I) <> INT(A(I)) THEN 560
610 (3) NEXT I
620 (1) PRINT "DO YOU WANT TO MOVE FIRST";
630 (1) INPUT Q9$
640 (1) IF Q9$ = "YES" THEN 1450
650 (0) IF Q9$ = "yes" THEN 1450
660 (0) IF Q9$ = "NO" THEN 700
670 (0) IF Q9$ = "no" THEN 700
680 (0) PRINT "PLEASE ANSWER YES OR NO."
690 (0) GOTO 630
700 (4) IF W = 1 THEN 940
710 (4) LET C = 0
720 (4) FOR I = 1 TO N
730 (12) IF A(I) = 0 THEN 770
740 (8) LET C = C + 1
750 (8) IF C = 3 THEN 840
760 (7) LET D(C) = I
770 (11) NEXT I
780 (3) IF C = 2 THEN 920
790 (1) IF A(D(1)) > 1 THEN 820
800 (0) PRINT "MACHINE LOSES"
810 (0) GOTO 1640
820 (1) PRINT "MACHINE WINS"
830 (1) GOTO 1640
840 (1) LET C = 0
850 (1) FOR I = 1 TO N
860 (1) IF A(I) > 1 THEN 940
870 (0) IF A(I) = 0 THEN 890
880 (0) LET C = C + 1
890 (0) NEXT I
900 (0) IF C / 2 <> INT(C / 2) THEN 800
910 (0) GOTO 940
920 (2) IF A(D(1)) = 1 THEN 820
930 (2) IF A(D(2)) = 1 THEN 820
940 (3) FOR I = 1 TO N
950 (9) LET E = A(I)
960 (9) FOR J = 0 TO 10
970 (99) LET F = E / 2
980 (99) LET B(I, J) = 2 * (F - INT(F))
990 (99) LET E = INT(F)
1000 (99) NEXT J
1010 (9) NEXT I
1020 (3) FOR J = 10 TO 0 STEP -1
1030 (30) LET C = 0
1040 (30) LET H = 0
1050 (30) FOR I = 1 TO N
1060 (90) IF B(I, J) = 0 THEN 1110
1070 (7) LET C = C + 1
1080 (7) IF A(I) <= H THEN 1110
1090 (6) LET H = A(I)
1100 (6) LET G = I
1110 (90) NEXT I
1120 (30) IF C / 2 <> INT(C / 2) THEN 1190
1130 (27) NEXT J
1140 (0) LET E = INT(N * RND(1) + 1)
1150 (0) IF A(E) = 0 THEN 1140
1160 (0) LET F = INT(A(E) * RND(1) + 1)
1170 (0) LET A(E) = A(E) - F
1180 (0) GOTO 1380
1190 (3) LET A(G) = 0
1200 (3) FOR J = 0 TO 10
1210 (33) LET B(G, J) = 0
1220 (33) LET C = 0
1230 (33) FOR I = 1 TO N
1240 (99) IF B(I, J) = 0 THEN 1260
1250 (5) LET C = C + 1
1260 (99) NEXT I
1270 (33) LET A(G) = A(G) + 2 * (C / 2 - INT(C / 2)) * 2 ^ J
1280 (33) NEXT J
1290 (3) IF W = 1 THEN 1380
1300 (3) LET C = 0
1310 (3) FOR I = 1 TO N
1320 (6) IF A(I) > 1 THEN 1380
1330 (3) IF A(I) = 0 THEN 1350
1340 (0) LET C = C + 1
1350 (3) NEXT I
1360 (0) IF C / 2 <> INT(C / 2) THEN 1380
1370 (0) LET A(G) = 1 - A(G)
1380 (3) PRINT "PILE  SIZE"
1390 (3) FOR I = 1 TO N
1400 (9) PRINT I; A(I)
1410 (9) NEXT I
1420 (3) IF W = 2 THEN 1450
1430 (0) GOSUB 1570
1440 (0) IF Z = 1 THEN 820
1450 (4) PRINT "YOUR MOVE - PILE, NUMBER TO BE REMOVED";
1460 (4) INPUT X, Y
1470 (4) IF X > N THEN 1450
1480 (4) IF X < 1 THEN 1450
1490 (4) IF X <> INT(X) THEN 1450
1500 (4) IF Y > A(X) THEN 1450
1510 (4) IF Y < 1 THEN 1450
1520 (4) IF Y <> INT(Y) THEN 1450
1530 (4) LET A(X) = A(X) - Y
1540 (4) GOSUB 1570
1550 (4) IF Z = 1 THEN 800
1560 (4) GOTO 700
1570 G(1570) (4) LET Z = 0
1580 G(1570) (4) FOR I = 1 TO N
1590 G(1570) (8) IF A(I) = 0 THEN 1610
1600 G(1570) (4) RETURN
1610 G(1570) (4) NEXT I
1620 G(1570) (0) LET Z = 1
1630 G(1570) (0) RETURN
1640 (1) PRINT "do you want to play another game";
1650 (1) INPUT Q9$
1660 (1) IF Q9$ = "YES" THEN 1720
1670 (1) IF Q9$ = "yes" THEN 1720
1680 (1) IF Q9$ = "NO" THEN 1730
1690 (0) IF Q9$ = "no" THEN 1730
1700 (0) PRINT "PLEASE.  YES OR NO."
1710 (0) GOTO 1650
1720 (0) GOTO 440
1730 (1) END

