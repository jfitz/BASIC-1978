                                 BATTLE
               CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY

THE FOLLOWING CODE OF THE BAD GUYS' FLEET DISPOSITION
HAS BEEN CAPTURED BUT NOT DECODED:

 0  5  0  0  0  0 
 0  5  0  3  3  3 
 0  5  6  4  4  4 
 0  5  6  0  0  0 
 0  0  6  1  0  2 
 0  0  6  0  1  2 

DE-CODE IT AND USE IT IF YOU CAN
BUT KEEP THE DE-CODING METHOD A SECRET.

START GAME
? 1,1
SPLASH!  TRY AGAIN.
? 1,3
SPLASH!  TRY AGAIN.
? 1,5
A DIRECT HIT ON SHIP NUMBER 5
TRY AGAIN.
? 2,2
A DIRECT HIT ON SHIP NUMBER 3
TRY AGAIN.
? 2,4
SPLASH!  TRY AGAIN.
? 2,6
SPLASH!  TRY AGAIN.
? 3,1
A DIRECT HIT ON SHIP NUMBER 4
TRY AGAIN.
? 3,3
A DIRECT HIT ON SHIP NUMBER 4
TRY AGAIN.
? 3,5
A DIRECT HIT ON SHIP NUMBER 5
TRY AGAIN.
? 
? 
Error 102 End of file in line 1180

5.0 (1) PRINT TAB(33); "BATTLE"
7.0 (1) PRINT TAB(15); "CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
10.0 (1) REM -- BATTLE WRITTEN BY RAY WESTERGARD  10/70
20.0 (1) REM COPYRIGHT 1971 BY THE REGENTS OF THE UNIV. OF CALIF.
30.0 (1) REM PRODUCED AT THE LAWRENCE HALL OF SCIENCE, BERKELEY
40.0 (1) DIM F(6, 6), H(6, 6), A(4), B(4), C(6), L(3)
50.0 (1) FOR X = 1 TO 6
51.0 (6) FOR Y = 1 TO 6
52.0 (36) F(X, Y) = 0
53.0 (36) NEXT Y
54.0 (6) NEXT X
60.0 (1) FOR I = 1 TO 3
70.0 (3) N = 4 - I
80.0 (3) FOR J = 1 TO 2
90.0 (12) A = INT(6 * RND(1) + 1)
100.0 (12) B = INT(6 * RND(1) + 1)
110.0 (12) D = INT(4 * RND(1) + 1)
120.0 (12) IF F(A, B) > 0 THEN 90
130.0 (10) M = 0
140.0 (10) ON D GOTO 150, 340, 550, 740
150.0 (4) B(1) = B
160.0 (4) B(2) = 7
160.1 (4) B(3) = 7
170.0 (4) FOR K = 1 TO N
180.0 (9) IF M > 1 THEN 240
190.0 (7) IF B(K) = 6 THEN 230
200.0 (4) IF F(A, B(K) + 1) > 0 THEN 230
210.0 (4) B(K + 1) = B(K) + 1
220.0 (4) GOTO 280
230.0 (3) M = 2
240.0 (5) IF B(1) < B(2) AND B(1) < B(3) THEN Z = B(1)
242.0 (5) IF B(2) < B(1) AND B(2) < B(3) THEN Z = B(2)
244.0 (5) IF B(3) < B(1) AND B(3) < B(2) THEN Z = B(3)
250.0 (5) IF Z = 1 THEN 90
260.0 (5) IF F(A, Z - 1) > 0 THEN 90
270.0 (4) B(K + 1) = Z - 1
280.0 (8) NEXT K
290.0 (3) F(A, B) = 9 - 2 * I - J
300.0 (3) FOR K = 1 TO N
310.0 (7) F(A, B(K + 1)) = F(A, B)
320.0 (7) NEXT K
330.0 (3) GOTO 990
340.0 (1) A(1) = A
350.0 (1) B(1) = B
360.0 (1) A(2) = 0
360.1 (1) A(3) = 0
360.2 (1) B(2) = 0
360.3 (1) B(3) = 0
370.0 (1) FOR K = 1 TO N
380.0 (1) IF M > 1 THEN 460
390.0 (1) IF A(K) = 1 OR B(K) = 1 THEN 450
400.0 (1) IF F(A(K) - 1, B(K) - 1) > 0 THEN 450
410.0 (0) IF F(A(K) - 1, B(K)) > 0 AND F(A(K) - 1, B(K)) = F(A(K), B(K) - 1) THEN 450
420.0 (0) A(K + 1) = A(K) - 1
430.0 (0) B(K + 1) = B(K) - 1
440.0 (0) GOTO 530
450.0 (1) M = 2
460.0 (1) IF A(1) > A(2) AND A(1) > A(3) THEN Z1 = A(1)
462.0 (1) IF A(2) > A(1) AND A(2) > A(3) THEN Z1 = A(2)
464.0 (1) IF A(3) > A(1) AND A(3) > A(2) THEN Z1 = A(3)
470.0 (1) IF B(1) > B(2) AND B(1) > B(3) THEN Z2 = B(1)
474.0 (1) IF B(2) > B(1) AND B(2) > B(3) THEN Z2 = B(2)
476.0 (1) IF B(3) > B(1) AND B(3) > B(2) THEN Z2 = B(3)
480.0 (1) IF Z1 = 6 OR Z2 = 6 THEN 90
490.0 (1) IF F(Z1 + 1, Z2 + 1) > 0 THEN 90
500.0 (1) IF F(Z1, Z2 + 1) > 0 AND F(Z1, Z2 + 1) = F(Z1 + 1, Z2) THEN 90
510.0 (1) A(K + 1) = Z1 + 1
520.0 (1) B(K + 1) = Z2 + 1
530.0 (1) NEXT K
540.0 (1) GOTO 950
550.0 (2) A(1) = A
560.0 (2) A(2) = 7
560.1 (2) A(3) = 7
570.0 (2) FOR K = 1 TO N
580.0 (4) IF M > 1 THEN 640
590.0 (3) IF A(K) = 6 THEN 630
600.0 (2) IF F(A(K) + 1, B) > 0 THEN 630
610.0 (2) A(K + 1) = A(K) + 1
620.0 (2) GOTO 680
630.0 (1) M = 2
640.0 (2) IF A(1) < A(2) AND A(1) < A(3) THEN Z = A(1)
642.0 (2) IF A(2) < A(1) AND A(2) < A(3) THEN Z = A(2)
644.0 (2) IF A(3) < A(1) AND A(3) < A(2) THEN Z = A(3)
650.0 (2) IF Z = 1 THEN 90
660.0 (2) IF F(Z - 1, B) > 0 THEN 90
670.0 (2) A(K + 1) = Z - 1
680.0 (4) NEXT K
690.0 (2) F(A, B) = 9 - 2 * I - J
700.0 (2) FOR K = 1 TO N
710.0 (4) F(A(K + 1), B) = F(A, B)
720.0 (4) NEXT K
730.0 (2) GOTO 990
740.0 (3) A(1) = A
750.0 (3) B(1) = B
760.0 (3) A(2) = 7
760.1 (3) A(3) = 7
770.0 (3) B(2) = 0
770.1 (3) B(3) = 0
780.0 (3) FOR K = 1 TO N
790.0 (3) IF M > 1 THEN 870
800.0 (3) IF A(K) = 6 OR B(K) = 1 THEN 860
810.0 (3) IF F(A(K) + 1, B(K) - 1) > 0 THEN 860
820.0 (0) IF F(A(K) + 1, B(K)) > 0 AND F(A(K) + 1, B(K)) = F(A(K), B(K) - 1) THEN 860
830.0 (0) A(K + 1) = A(K) + 1
840.0 (0) B(K + 1) = B(K) - 1
850.0 (0) GOTO 940
860.0 (3) M = 2
870.0 (3) IF A(1) < A(2) AND A(1) < A(3) THEN Z1 = A(1)
872.0 (3) IF A(2) < A(1) AND A(2) < A(3) THEN Z1 = A(2)
874.0 (3) IF A(3) < A(1) AND A(3) < A(2) THEN Z1 = A(3)
880.0 (3) IF B(1) > B(2) AND B(1) > B(3) THEN Z2 = B(1)
882.0 (3) IF B(2) > B(1) AND B(2) > B(3) THEN Z2 = B(2)
884.0 (3) IF B(3) > B(1) AND B(3) > B(2) THEN Z2 = B(3)
890.0 (3) IF Z1 = 1 OR Z2 = 6 THEN 90
900.0 (0) IF F(Z1 - 1, Z2 + 1) > 0 THEN 90
910.0 (0) IF F(Z1, Z2 + 1) > 0 AND F(Z1, Z2 + 1) = F(Z1 - 1, Z2) THEN 90
920.0 (0) A(K + 1) = Z1 - 1
930.0 (0) B(K + 1) = Z2 + 1
940.0 (0) NEXT K
950.0 (1) F(A, B) = 9 - 2 * I - J
960.0 (1) FOR K = 1 TO N
970.0 (1) F(A(K + 1), B(K + 1)) = F(A, B)
980.0 (1) NEXT K
990.0 (6) NEXT J
1000.0 (3) NEXT I
1010.0 (1) PRINT
1020.0 (1) PRINT "THE FOLLOWING CODE OF THE BAD GUYS' FLEET DISPOSITION"
1030.0 (1) PRINT "HAS BEEN CAPTURED BUT NOT DECODED:"
1040.0 (1) PRINT
1050.0 (1) FOR I = 1 TO 6
1051.0 (6) FOR J = 1 TO 6
1052.0 (36) H(I, J) = F(J, I)
1053.0 (36) NEXT J
1054.0 (6) NEXT I
1060.0 (1) FOR I = 1 TO 6
1061.0 (6) FOR J = 1 TO 6
1062.0 (36) PRINT H(I, J);
1063.0 (36) NEXT J
1064.0 (6) PRINT
1065.0 (6) NEXT I
1070.0 (1) PRINT
1080.0 (1) PRINT "DE-CODE IT AND USE IT IF YOU CAN"
1090.0 (1) PRINT "BUT KEEP THE DE-CODING METHOD A SECRET."
1100.0 (1) PRINT
1110.0 (1) FOR I = 1 TO 6
1111.0 (6) FOR J = 1 TO 6
1112.0 (36) H(I, J) = 0
1113.0 (36) NEXT J
1114.0 (6) NEXT I
1120.0 (1) FOR I = 1 TO 3
1121.0 (3) L(I) = 0
1122.0 (3) NEXT I
1130.0 (1) C(1) = 2
1130.1 (1) C(2) = 2
1140.0 (1) C(3) = 1
1140.1 (1) C(4) = 1
1150.0 (1) C(5) = 0
1150.1 (1) C(6) = 0
1160.0 (1) S = 0
1160.1 (1) H = 0
1170.0 (1) PRINT "START GAME"
1180.0 (9) INPUT X, Y
1190.0 (9) IF X < 1 OR X > 6 OR INT(X) <> ABS(X) THEN 1210
1200.0 (9) IF Y > 0 AND Y < 7 AND INT(Y) = ABS(Y) THEN 1230
1210.0 (0) PRINT "INVALID INPUT.  TRY AGAIN."
1220.0 (0) GOTO 1180
1230.0 (9) R = 7 - Y
1240.0 (9) C = X
1250.0 (9) IF F(R, C) > 0 THEN 1290
1260.0 (4) S = S + 1
1270.0 (4) PRINT "SPLASH!  TRY AGAIN."
1280.0 (4) GOTO 1180
1290.0 (5) IF C(F(R, C)) < 4 THEN 1340
1300.0 (0) PRINT "THERE USED TO BE A SHIP AT THAT POINT, BUT YOU SUNK IT."
1310.0 (0) PRINT "SPLASH!  TRY AGAIN."
1320.0 (0) S = S + 1
1330.0 (0) GOTO 1180
1340.0 (5) IF H(R, C) > 0 THEN 1420
1350.0 (5) H = H + 1
1360.0 (5) H(R, C) = F(R, C)
1370.0 (5) PRINT "A DIRECT HIT ON SHIP NUMBER"; F(R, C)
1380.0 (5) C(F(R, C)) = C(F(R, C)) + 1
1390.0 (5) IF C(F(R, C)) >= 4 THEN 1470
1400.0 (5) PRINT "TRY AGAIN."
1410.0 (5) GOTO 1180
1420.0 (0) PRINT "YOU ALREADY PUT A HOLE IN SHIP NUMBER"; F(R, C);
1430.0 (0) PRINT "AT THAT POINT."
1440.0 (0) PRINT "SPLASH!  TRY AGAIN."
1450.0 (0) S = S + 1
1460.0 (0) GOTO 1180
1470.0 (0) L((INT(F(R, C) - 1) / 2) + 1) = L((INT(F(R, C) - 1) / 2) + 1) + 1
1480.0 (0) PRINT "AND YOU SUNK IT.  HURRAH FOR THE GOOD GUYS."
1490.0 (0) PRINT "SO FAR, THE BAD GUYS HAVE LOST"
1500.0 (0) PRINT L(1); "DESTROYER(S),"; L(2); "CRUISER(S), AND";
1510.0 (0) PRINT L(3); "AIRCRAFT CARRIER(S)."
1520.0 (0) PRINT "YOUR CURRENT SPLASH/HIT RATIO IS"; S / H
1530.0 (0) IF (L(1) + L(2) + L(3)) < 6 THEN 1180
1540.0 (0) PRINT
1550.0 (0) PRINT "YOU HAVE TOTALLY WIPED OUT THE BAD GUYS' FLEET"
1560.0 (0) PRINT "WITH A FINAL SPLASH/HIT RATIO OF"; S / H
1570.0 (0) IF S / H > 0 THEN 1590
1580.0 (0) PRINT "CONGRATULATIONS -- A DIRECT HIT EVERY TIME."
1590.0 (0) PRINT
1600.0 (0) PRINT "****************************"
1610.0 (0) PRINT
1620.0 (0) GOTO 50
1630.0 (0) END

